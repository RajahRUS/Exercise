
use movies
db.stats()
db.tags.find().limit(3)

db.getCollectionNames()
db.test_db.find({$or: [{gender: 'm'}, {home: 'Moscow'}]})

db.tags.aggregate({$group: {_id :"id", tag_sum: {$count: "id" }}})


db.tags.aggregate({$group: {_id :"id", tag_sum: {$sum : 1 }}})

print("tags count: ", db.tags.aggregate({$group: {_id :"id", tag_sum: {$sum : 1 }}}));

db.tags.aggregate([{$match: {"name" : "woman"}},{$group: {_id :"id", tag_sum: {$sum : 1 }}}])

print("woman tags count: ", db.tags.aggregate([{$match: {"name" : "woman"}},{$group: {_id :"id", tag_sum: {$sum : 1 }}}]));



db.tags.aggregate([ 
                   {"$group": {_id :"$name", tag_sum: {$sum : 1 }}}
	,{$sort: { tag_sum: -1 } },{$limit: 3}])